# Changelog

- [Changelog](#changelog)
  - [5.1.1 (2025-07-08)](#511-2025-07-08)
    - [Changed](#changed)
  - [5.1.0 (2025-07-05)](#510-2025-07-05)
    - [Changed](#changed-1)
  - [5.0.1 (2025-06-27)](#501-2025-06-27)
    - [Fixed](#fixed)
  - [5.0.0 (2025-06-27)](#500-2025-06-27)
    - [Added](#added)
    - [Changed](#changed-2)
  - [4.0.1 (2025-06-24)](#401-2025-06-24)
    - [Fixed](#fixed-1)
  - [4.0.0 (2025-06-24)](#400-2025-06-24)
    - [Added](#added-1)
    - [Changed](#changed-3)
  - [3.10.1 (2025-06-18)](#3101-2025-06-18)
    - [Changed](#changed-4)
  - [3.10.0 (2025-06-10)](#3100-2025-06-10)
    - [Added](#added-2)
  - [3.9.1 (2025-06-09)](#391-2025-06-09)
    - [Changed](#changed-5)
  - [3.9.0 (2025-05-29)](#390-2025-05-29)
    - [Changed](#changed-6)
  - [3.8.11 (2025-05-28)](#3811-2025-05-28)
    - [Changed](#changed-7)
  - [3.8.10 (2025-05-20)](#3810-2025-05-20)
    - [Changed](#changed-8)
  - [3.8.9 (2025-05-12)](#389-2025-05-12)
    - [Fixed](#fixed-2)
  - [3.8.8 (2025-05-12)](#388-2025-05-12)
    - [Changed](#changed-9)
  - [3.8.7 (2025-05-12)](#387-2025-05-12)
    - [Added](#added-3)
  - [3.8.6 (2025-04-09)](#386-2025-04-09)
    - [Changed](#changed-10)
  - [3.8.5 (2025-04-03)](#385-2025-04-03)
    - [Fixed](#fixed-3)
  - [3.8.4 (2025-04-03)](#384-2025-04-03)
    - [Fixed](#fixed-4)
  - [3.8.3 (2025-04-03)](#383-2025-04-03)
    - [Fixed](#fixed-5)
  - [3.8.2 (2025-04-03)](#382-2025-04-03)
    - [Fixed](#fixed-6)
  - [3.8.1 (2025-04-03)](#381-2025-04-03)
    - [Fixed](#fixed-7)
    - [Changed](#changed-11)
  - [3.8.0 (2025-04-03)](#380-2025-04-03)
    - [Added](#added-4)
  - [3.7.1 (2025-03-26)](#371-2025-03-26)
    - [Changed](#changed-12)
  - [3.7.0 (2025-03-20)](#370-2025-03-20)
    - [Changed](#changed-13)
  - [3.6.0 (2025-03-19)](#360-2025-03-19)
    - [Changed](#changed-14)
  - [3.5.0 (2025-02-14)](#350-2025-02-14)
    - [Changed](#changed-15)
  - [3.4.0 (2025-02-11)](#340-2025-02-11)
    - [Changed](#changed-16)
  - [3.3.4 (2025-01-28)](#334-2025-01-28)
    - [Changed](#changed-17)
  - [3.3.3 (2024-01-15)](#333-2024-01-15)
    - [Changed](#changed-18)
  - [3.3.2 (2025-01-15)](#332-2025-01-15)
    - [Changed](#changed-19)
  - [3.3.1 (2025-01-10)](#331-2025-01-10)
    - [Added](#added-5)
  - [3.2.12 (2024-12-05)](#3212-2024-12-05)
    - [Changed](#changed-20)
  - [3.2.11 (2024-11-21)](#3211-2024-11-21)
    - [Changed](#changed-21)
  - [3.2.10 (2024-11-18)](#3210-2024-11-18)
    - [Changed](#changed-22)
  - [3.2.9 (2024-11-15)](#329-2024-11-15)
    - [Changed](#changed-23)
  - [3.2.7 (2024-11-15)](#327-2024-11-15)
    - [Added](#added-6)
    - [Changed](#changed-24)
  - [3.2.6 (2024-10-29)](#326-2024-10-29)
    - [Added](#added-7)
    - [Changed](#changed-25)
  - [3.2.5 (2024-10-24)](#325-2024-10-24)
    - [Changed](#changed-26)
  - [3.2.4 (2024-10-17)](#324-2024-10-17)
    - [Fixed](#fixed-8)
  - [3.2.3 (2024-10-16)](#323-2024-10-16)
    - [Fixed](#fixed-9)
  - [3.2.2 (2024-10-09)](#322-2024-10-09)
    - [Changed](#changed-27)
  - [3.2.1 (2024-09-20)](#321-2024-09-20)
    - [Changed](#changed-28)
  - [3.2.0 (2024-08-29)](#320-2024-08-29)
    - [Changed](#changed-29)
  - [3.1.2 (2024-08-23)](#312-2024-08-23)
    - [Changed](#changed-30)
  - [3.1.1 (2024-08-23)](#311-2024-08-23)
    - [Fixed](#fixed-10)
  - [3.1.0 (2024-08-22)](#310-2024-08-22)
    - [Added](#added-8)
  - [3.0.6 (2024-08-22)](#306-2024-08-22)
    - [Changed](#changed-31)
  - [3.0.5 (2024-08-21)](#305-2024-08-21)
    - [Fixed](#fixed-11)
  - [3.0.4 (2024-08-21)](#304-2024-08-21)
    - [Changed](#changed-32)
    - [Added](#added-9)
  - [2.9.3 (2024-08-16)](#293-2024-08-16)
    - [Fixed](#fixed-12)
  - [2.9.2 (2024-08-13)](#292-2024-08-13)
    - [Changed](#changed-33)
  - [2.9.1 (2024-08-10)](#291-2024-08-10)
    - [Added](#added-10)
    - [Changed](#changed-34)
  - [2.9.0 (2024-08-01)](#290-2024-08-01)
    - [Added](#added-11)
    - [Changed](#changed-35)
    - [Fixed](#fixed-13)
  - [2.8.0](#280)
    - [Added](#added-12)
    - [Changed](#changed-36)
    - [Fixed](#fixed-14)
  - [2.7.3](#273)
    - [Changed](#changed-37)
    - [Fixed](#fixed-15)
  - [2.7.2](#272)
    - [Fixed](#fixed-16)
  - [2.7.0](#270)
    - [Changed](#changed-38)
  - [2.6.2](#262)
    - [Added](#added-13)
    - [Changed](#changed-39)
  - [2.6.0](#260)
    - [Added](#added-14)
  - [2.4.0](#240)
    - [Added](#added-15)
  - [2.3.0](#230)
    - [Added](#added-16)
  - [2.2.0](#220)
    - [Added](#added-17)
  - [2.1.0](#210)
    - [Changed](#changed-40)
  - [2.0.0](#200)
    - [Changed](#changed-41)

## 5.1.1 (2025-07-08)

### Changed

* Better default timeouts for HTTP/2 based shared rendering.

## 5.1.0 (2025-07-05)

### Changed

* Better dependency hostname handling (default templated hostnames).

## 5.0.1 (2025-06-27)

### Fixed

* Misprint in the Grafana dashboard resource.

## 5.0.0 (2025-06-27)

### Added

* `observability.metrics.prometheusEndpoint` to allow enabling Prometheus endpoint for scraping metrics.
* `observability.metrics.customTags` to set custom tags for all exporters.

### Changed

* [Document Engine 1.10.0](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.10.0).
* Removed `prometheusExporter`, due to the new native support of Prometheus metrics.
* Removed redundant `observability.metrics.enabled`.

## 4.0.1 (2025-06-24)

### Fixed

* A very stupid mistake with dates in the cleanup jobs.
* Removed unnecessary port exposure.

## 4.0.0 (2025-06-24)

### Added

* New cleanup job way through the dedicated API instead of the direct database query workaround. Important limitation: document id filtering does not currently work, only the retention time (`documentLifecycle.cleanupJob.keepHours`).

### Changed

* Improved the tests.
* Updated dependency charts.

## 3.10.1 (2025-06-18)

### Changed

* Minor improvements.

## 3.10.0 (2025-06-10)

### Added

* `config.http2SharedRendering.enabled` (`false` by default) to allow new (better) shared rendering using HTTP/2, which requires load balancer to support that.

## 3.9.1 (2025-06-09)

### Changed

* `README.md` update.
* Polished the schema.

## 3.9.0 (2025-05-29)

### Changed

* [Document Engine 1.9.0](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.9.0).


## 3.8.11 (2025-05-28)

### Changed

* Better timeout defaults.
* Documented timeout relations.

## 3.8.10 (2025-05-20)

### Changed

* Better defaults for horisontal pod autoscaling.
* Updated dependencies.

## 3.8.9 (2025-05-12)

### Fixed

* Grafana dashboard improvement fix.

## 3.8.8 (2025-05-12)

### Changed

* Grafana dashboard improvement.

## 3.8.7 (2025-05-12)

### Added

* Additional selectors for the pod template in Deployment: `deploymentExtraSelectorLabels`. Can be used to separate pods for debugging and testing purposes. 

## 3.8.6 (2025-04-09)

### Changed

* [Document Engine 1.8.3](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.8.3)

## 3.8.5 (2025-04-03)

### Fixed

* Final touch on dashboard uniqueness.

## 3.8.4 (2025-04-03)

### Fixed

* Found the cause of dashboard discoverability problem.

## 3.8.3 (2025-04-03)

### Fixed

* More dashboard discoverability problems.

## 3.8.2 (2025-04-03)

### Fixed

* Another dashboard hiccup.

## 3.8.1 (2025-04-03)

### Fixed

* More unique Grafana dashboard UID.

### Changed

* Added Grafana dashboard tags

## 3.8.0 (2025-04-03)

### Added

* Grafana dashboard through a ConfigMap. Use: 
  * `observability.metrics.grafanaDashboard.enabled` to enable — also requires Prometheus exporter and StatsD output
  * `observability.metrics.grafanaDashboard.title` — to change the dashboard title
  * `observability.metrics.grafanaDashboard.allNamespaces` — to cover all namespaces instead of the release one

## 3.7.1 (2025-03-26)

### Changed

* [Document Engine 1.8.2](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.8.2)

## 3.7.0 (2025-03-20)

### Changed

* [Document Engine 1.8.1](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.8.1)

## 3.6.0 (2025-03-19)

### Changed

* [Document Engine 1.8.0](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.8.0)

## 3.5.0 (2025-02-14)

### Changed

* [Document Engine 1.7.0](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.7.0)

## 3.4.0 (2025-02-11)

### Changed

* [Document Engine 1.6.0](https://www.nutrient.io/guides/document-engine/release-notes/changelog/#1.6.0)

## 3.3.4 (2025-01-28)

### Changed

* [Document Engine 1.5.6](https://www.nutrient.io/changelog/document-engine/#1.5.6)

## 3.3.3 (2024-01-15)

### Changed

* Updated Network Policy to allow inter-node communication.

## 3.3.2 (2025-01-15)

### Changed

* Updated statsd_exporter and dependency chart versions.

## 3.3.1 (2025-01-10)

### Added

* Support for creating Erlang cluster using Kubernetes DNS.

## 3.2.12 (2024-12-05)

### Changed

* [Document Engine 1.5.5](https://www.nutrient.io/changelog/document-engine/#1.5.5)

## 3.2.11 (2024-11-21)

### Changed

* [Document Engine 1.5.4](https://www.nutrient.io/changelog/document-engine/#1.5.4)

## 3.2.10 (2024-11-18)

### Changed

* Removed earlier added default `lifecycle`: dumb-init makes it unnecessary.

## 3.2.9 (2024-11-15)

### Changed

* More labels (e.g. `helm.sh/chart`) added to pods.

## 3.2.7 (2024-11-15)

### Added

* Revision history limit setting for Document Engine Deployment: `revisionHistoryLimit`.

### Changed

* Added a meaningful default for `lifecycle.preStop` to make Document Engine properly receive `SIGTERM`.

## 3.2.6 (2024-10-29)

### Added

* Support for file upload timeout for asset storage by setting `assetStorage.fileUploadTimeoutSeconds`.
* Spreadhseet content size limitations as `documentConversion.spreadsheetMaxContentHeightMm` and `documentConversion.spreadsheetMaxContentWidthMm`.

### Changed

* [Document Engine 1.5.3](https://www.nutrient.io/changelog/document-engine/#1.5.3)

## 3.2.5 (2024-10-24)

### Changed

* Documentation changes following the company rebrand: we are now Nutrient. 

## 3.2.4 (2024-10-17)

### Fixed

* `podAnnotations` use in `storage-migration-job.yaml`

## 3.2.3 (2024-10-16)

### Fixed

* Simple values corrections.

## 3.2.2 (2024-10-09)

### Changed

* [Document Engine 1.5.2](https://www.nutrient.io/changelog/document-engine/#1.5.2)

## 3.2.1 (2024-09-20)

### Changed

* [Document Engine 1.5.1](https://www.nutrient.io/changelog/document-engine/#1.5.1)

## 3.2.0 (2024-08-29)

### Changed

* [Document Engine 1.5.0](https://www.nutrient.io/changelog/document-engine/#1.5.0)

## 3.1.2 (2024-08-23)

### Changed

* Polishing schema based on the available usage scenarios. 
* Dependency charts versions update.
* Documentation layout change.

## 3.1.1 (2024-08-23)

### Fixed

* Wrong value type for `terminationGracePeriodSeconds`

## 3.1.0 (2024-08-22)

### Added

* Schema using [helm values schema json plugin](https://github.com/losisin/helm-values-schema-json)

## 3.0.6 (2024-08-22)

### Changed

* Documentation cleanup

## 3.0.5 (2024-08-21)

### Fixed

* Commit mistake correction

## 3.0.4 (2024-08-21)

> [!WARNING]
> Breaking changes. 
> We hope that `values.yaml` will now be much more readable and usable.

### Changed

* Massive internal refactoring.
* Documentation generation.
* `pspdfkit.license.isOffline` is removed, as it is no longer necessary
* `pspdfkit.license` section moved to the top level as `documentEngineLicense`.
* `pspdfkit.auth.api` section moved to the top level as `apiAuth`, both `pspdfkit.auth.api.apiToken` and `pspdfkit.auth.api.jwt` section.
* `pspdfkit.secretKeyBase` restructured:
  * `pspdfkit.secretKeyBase.value` moved to `apiAuth.secretKeyBase`
  * Former optional `pspdfkit.secretKeyBase.externalSecret` integrated into `apiAuth.externalSecret`:
    * In case `apiAuth.externalSecret.secretKeyBaseKey` is set, the value is used.
* `pspdfkit.storage.cleanupJob` becomes `documentLifecycle.cleanupJob`
* Database-related part of `pspdfkit.storage` moved to `database`:
  * `pspdfkit.storage.postgres.enabled` becomes `database.enabled`
  * The rest of `pspdfkit.storage.postgres` becomes `database.postgres`
  * `pspdfkit.storage.databaseEngine` becomes `database.engine`, only `postgres` is currently supported (formerly `postgresql`)
  * `pspdfkit.storage.databaseConnections` becomes `database.connections`
  * `pspdfkit.storage.databaseMigrationJob` becomes `database.migrationJob`
* The remaining `pspdfkit.storage` section moved to the top level as `assetStorage`.
  * `pspdfkit.assetStorageCacheSizeMegaBytes` renamed to `assetStorage.localCacheSizeMegabytes`.
  * `pspdfkit.storage.assetStorageBackend` renamed to `assetStorage.backendType`
  * `pspdfkit.storage.enableAssetStorageFallback*` moved to `assetStorage.backendFallback` section
  * `pspdfkit.storage.redis.useTtlForPrerendering` renamed to `assetStorage.redis.useTtl`
* `pspdfkit.signingService` section moved to the top level as `documentSigningService`.
  * `pspdfkit.signingService.digitalSignatureHashAlgorithm` renamed to `documentSigningService.hashAlgorithm`
  * `pspdfkit.signingService.digitalSignatureCadesLevel` renamed to `documentSigningService.cadesLevel`
  * `pspdfkit.signingService.digitalSignatureCertificateCheckTime` renamed to `documentSigningService.certificateCheckTime`
* Certificate trust configuration restructured into the new `certificateTrust` section:
  * Map `pspdfkit.signingTrustConfigMaps` becomes list `certificateTrust.digitalSignatures` allowing both ConfigMaps and Secrets
  * Map `pspdfkit.trustConfigMaps` becomes list `certificateTrust.customCertificates` allowing both ConfigMaps and Secrets
  * `pspdfkit.downloaderTrustFileName` moved to `certificateTrust.downloaderTrustFileName` and is now empty by default which will set HTTP client trust to Mozilla CA bundle
  * `assetStorage.postgres.tls.trustFileName` will assume a file name from `/certificate-stores-custom`, which is filled from `certificateTrust.customCertificates`
* `pspdfkit.observability` section moved to the top level as `observability`.
  * `pspdfkit.log.level` moved into `observability.log.level`.
  * `metrics` section moved to `observability.metrics`.
* `pspdfkit.auth.dashboard` section became `dashboard`:
  * `pspdfkit.auth.dashboard.enabled` renamed to `dashboard.enabled`
  * The rest of the former section to `pspdfkit.dashboard.auth`
* The remaining `pspdfkit` section renamed to `config`.
* Aligned default values with the default [Document Engine configuration values](https://www.nutrient.io/guides/document-engine/configuration/options/), affects the following default values: 
  * `config.workerPoolSize` changed from `8` to `16`
  * `config.maxUploadSizeMegaBytes` changed from `128` to `950`
  * `config.urlFetchTimeoutSeconds` changed from `20` to `5`
  * `config.generationTimeoutSeconds` changed from `120` to `20`
  * `config.requestTimeoutSeconds` changed from `120` to `60`
  * `config.automaticLinkExtraction` changed from `true` to `false`
* Exceptions to the previous list:
  * `config.trustedProxies` is left as `default` for safety reasons

### Added

* Health check log level as `observability.healthcheckLevel`.
* Direct trust bundle for PostgreSQL as `assetStorage.postgres.trustBundle`.
* Option for host verification of PostgreSQL, `assetStorage.postgres.hostVerify`.
* Worker timeout in seconds as `config.workerTimeoutSeconds`.
* Asynchronous jobs timeout in seconds as `config.asyncJobsTtlSeconds`.
* HTTP proxy settings: `config.proxy.http` for HTTP and `config.proxy.https` for HTTPS
* Explicit StatsD exporting parameters in `observability.metrics.statsd` section.
* One more chart test.

## 2.9.3 (2024-08-16)

### Fixed

* Signing trust certificates configuration.

## 2.9.2 (2024-08-13)

### Changed

* Additional test to cover migration from Docker Compose by being friendly to putting _all_ into `envFrom`.

## 2.9.1 (2024-08-10)

### Added

* Support for secrets rotation enablement option. Setting `pspdfkit.replaceSecretsFromEnv` to `false` will make Document Engine to ignore `JWT_PUBLIC_KEY`, `SECRET_KEY_BASE` and `DASHBOARD_PASSWORD` environment variables, values (`pspdfkit.auth.api.jwt.publicKey`, `pspdfkit.secretKeyBase` and `pspdfkit.auth.dashboard.password`) and the corresponding secrets.

### Changed

* Minor cleanups

## 2.9.0 (2024-08-01)

### Added

* Azure blob storage support.
* Introduced `pspdfkit.signingTrustConfigMaps` for ConfigMaps to mount to `/certificate-stores/`

### Changed

* [Document Engine 1.4.1](https://www.nutrient.io/changelog/document-engine/#1.4.1)

### Fixed

* Asset storage fallback.

## 2.8.0

### Added

* Support for OpenTelemetry traces, enabled by setting `pspdfkit.observability.opentelemetry.enabled` to `true`. 
  * Unless the collector is placed as a sidecar and receives by grpc at port `4317`, other parameters are also necessary. 
  * Please note: standard OpenTelemetry environment variables are used, and the following values are just convenience wrappers, therefore other configuration approaches (e.g. setting variables through mutations or post build patches) will also work.
  * Wrapped parameters (see `values.yaml` for more details):
    * `pspdfkit.observability.opentelemetry.otlpExporterEndpoint` (`OTEL_EXPORTER_OTLP_ENDPOINT`)
    * `pspdfkit.observability.opentelemetry.otlpExporterProtocol` (`OTEL_EXPORTER_OTLP_PROTOCOL`)
    * `pspdfkit.observability.opentelemetry.otelServiceName` (`OTEL_SERVICE_NAME`)
    * `pspdfkit.observability.opentelemetry.otelResourceAttributes` (`OTEL_RESOURCE_ATTRIBUTES`)
    * `pspdfkit.observability.opentelemetry.otelPropagators` (`OTEL_PROPAGATORS`)
* Dependent charts for [MinIO](https://min.io/) and [Redis](https://redis.io/).

### Changed

* [Document Engine 1.4.0](https://www.nutrient.io/changelog/document-engine/#1.4.0)
* Changed `pspdfkit.storage.enableMigrationJobs` to `pspdfkit.storage.databaseMigrationJob.enabled`.
* Renamed `.Values.pspdfkit.storage.redis.sentinels` to `.Values.pspdfkit.storage.redis.sentinel`.
* Slight refinement of trust information parameters: all files from `pspdfkit.trustConfigMaps` are now mounted to `/certificate-stores-custom/` to avoid confusion with `/certificate-stores/` which services for document signature validation certificates.

### Fixed

* Minor cleanups.

## 2.7.3

### Changed

* Moved changes from [README.md](/charts/document-engine/README.md) here.

### Fixed

* Corrected the comment in `values.yaml` (thanks to [Blaise Schaeffer](https://github.com/blaise2s)).

## 2.7.2

### Fixed

* Installing without license.

## 2.7.0

### Changed

* [Document Engine 1.3.0](https://www.nutrient.io/changelog/document-engine/#1.3.0)

## 2.6.2

### Added

* Added `deploymentAnnotations` (courtesy of [k11h.de](https://github.com/k11h-de)).
* Added `pspdfkit.storage.cleanupJob.podAnnotations`.

### Changed

* Updated StatsD Prometheus exporter image tag.

## 2.6.0

### Added

* Added ServiceMonitor for Prometheus Operator (setting `metrics.serviceMonitor.enabled` to `true` should work in most cases).
* Added PrometheusRule for Prometheus Operator.

## 2.4.0

### Added

* Added support for NetworkPolicy.

## 2.3.0

### Added

* Added a possibility to override backend in Ingress resources, in order to enable special configurations (e.g. AWS Load Balancer Controller).

## 2.2.0

### Added

* Added `pspdfkit.trustConfigMaps`, a map of ConfigMap references for trust certificates
* Added `pspdfkit.downloaderTrustFileName` for remote file downloader certificates file from `pspdfkit.trustConfigMaps`
* Added `pspdfkit.storage.postgres.tls.verify` (defaults to `true`) to enable PostgreSQL TLS certificate validation
* Added `pspdfkit.storage.postgres.tls.trustFileName` to specify the trust certificates file from `pspdfkit.trustConfigMaps` for PostgreSQL connection

## 2.1.0

### Changed

* Value `dashboardIngress` replaced by `extraIngresses` map to accommodate to more complex endpoint scenarios.

## 2.0.0

### Changed

* No more `createSecret` values, condition for creating secret by the chart are moved into definition of the corresponding external secret names.
* Storage parameters are now expected to fully reside in `Secret` resources
  * `pspdfkit.storage.postgres.auth`, `pspdfkit.storage.s3.auth`, `pspdfkit.storage.redis.auth` maps were all merged into the corresponding `pspdfkit.storage` higher level maps
  * Redis secret is now expected to contain (if existsis) all Redis parameters, not only the password
